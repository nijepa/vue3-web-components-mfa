import{reactive as te,ref as f,onMounted as H,openBlock as s,createElementBlock as l,Fragment as j,createElementVNode as a,unref as h,renderList as Z,toDisplayString as p,useCssVars as ae,computed as T,watch as oe,normalizeStyle as D,createVNode as O,Transition as A,withCtx as P,normalizeClass as G,createTextVNode as R,createCommentVNode as u,withDirectives as ne,vModelText as se,createBlock as le,createStaticVNode as ie,defineCustomElement as re}from"vue";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const y of c.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&t(y)}).observe(document,{childList:!0,subtree:!0});function g(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function t(o){if(o.ep)return;o.ep=!0;const c=g(o);fetch(o.href,c)}})();const v=te({responseMessage:{isError:null,msg:null},sharedSecret:""}),C=async(r,i,g=void 0)=>{try{const t=await fetch(r,{method:i,body:JSON.stringify(g),headers:{"Content-type":"application/json"}});if(t.error)console.log(1,t);else return console.log(2,t),t.json()}catch(t){return console.log("Error: ",t),v.responseMessage.isError=!0,v.responseMessage.msg=t,{error:!0}}},ce={activation:[{label:"notes.important_note_title",tag:"h3",class:"content-title"},{label:"notes.mfa_info_01",tag:"p"},{label:"notes.mfa_info_011",tag:"p"},{label:"notes.mfa_info_012",tag:"p"},{label:"notes.mfa_info_013",tag:"p"},{label:"notes.mfa_info_014",tag:"p",style:"b"}],active:[{label:"buttons.activate_2fa",tag:"h3"},{label:"notes.mfa_info_02",tag:"p",isNote:!0},{label:"notes.installation_instruction",tag:"p"},{label:"notes.installation_steps",tag:"p"},{label:"notes.download_ios",tag:"a",href:"https://apps.apple.com/de/app/google-authenticator/id388497605"},{label:"notes.download_android",tag:"a",href:"https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=de&gl=US"},{label:"notes.installation_steps2",tag:"p"},{label:"",tag:"img"},{label:"",tag:"sec"},{label:"notes.installation_steps3",tag:"p"}],code:[{label:"notes.important_note_title",tag:"h3",class:"content-title"},{label:"notes.download_code_info",tag:"p",isNote:!0},{label:"notes.backup_codes",tag:"p"},{label:"notes.backup_codes_info",tag:"p"},{label:"notes.backup_codes_info2",tag:"p",style:"b"}],backup:[{label:"notes.backup_codes",tag:"p",style:"b"},{label:"notes.important_codes_info",tag:"p"},{label:"notes.backup_codes_info2",tag:"p",style:"b"}],deactivate:[{label:"notes.disable_2fa",tag:"p",style:"b"},{label:"notes.mfa_info_02",tag:"p",isNote:!0},{label:"notes.change_device",tag:"p",style:"b"},{label:"notes.link_device_info",tag:"p"},{label:"notes.device_instructions",tag:"p"},{label:"notes.disable_2fa",tag:"p",style:"b"},{label:"notes.confirm_disable_2fa",tag:"p"}],generate:[{label:"notes.enter_code",tag:"p",style:"b"},{label:"notes.generate_codes",tag:"p"}],download:[{label:"notes.save_codes",tag:"p",style:"b"},{label:"notes.received_codes_info",tag:"p"},{label:"notes.received_codes_info2",tag:"p"}],deactivation:[{label:"notes.deactivate",tag:"p",style:"b"},{label:"notes.generate_codes",tag:"p"}]};function de(r){const i=window.location.href;return i.slice(0,i.search("/cips/")+6)+r}const pe="/assets/ips-bc7c33ee.png",ue=["src"],me=a("hr",{class:"codes-hr"},null,-1),fe=a("h1",{class:"codes-title"}," BackUp-Codes für Ihre 2-Faktor-Authentifizierung ",-1),ge={class:"code-content"},be={class:"code-circle"},he={class:"code-code"},ve=a("footer",null,[a("div",{class:"info"},[a("p",null,"cadooz"),a("p",null,"GmbHOsterbekstraße 90b"),a("p",null,"22083 Hamburg – Germany")]),a("div",{class:"info"},[a("img",{src:pe,alt:""})])],-1),_e={__name:"BackupCodes",props:{logoUrl:{type:String,default:"../../assets/UllaPopken_logo_new.svg"},primaryColor:{type:String,default:""},codes:{type:Array,default:()=>["11111111","22222222","33333333","44444444","55555555"]}},setup(r){const i=r,g=f(null);var t;H(async()=>{t=await c(o.src),t=t.replace("text/html","image/jpeg"),console.log(555,t)});let o=i.logoUrl.replace('url("',"").replace('")',"");const c=async w=>{const E=await(await fetch(w)).blob();return new Promise(k=>{const M=new FileReader;M.readAsDataURL(E),M.onloadend=()=>{const d=M.result;k(d)}})};console.log(8,t);var y={content:["pdfmake (since it's based on pdfkit) supports JPEG and PNG format","If no width/height/fit is provided, image original size will be used","If you specify width, image will scale proportionally","If you specify both width and height - image will be stretched","You can also fit the image inside a rectangle","Images can be also provided in dataURL format...",'or be declared in an "images" dictionary and referenced by name'],images:{building:t}};const S=f(null);console.log(2,S);const U=()=>{var x;console.log(3,t);var w=htmlToPdfmake(y);w.images,pdfMake.vfs=(x=pdfFonts==null?void 0:pdfFonts.pdfMake)==null?void 0:x.vfs,pdfMake.createPdf(y).open()};return(w,x)=>(s(),l(j,null,[a("button",{onClick:U,class:"codes-btn"},"gen"),a("div",{id:"pdfTable",class:"codes-main",ref_key:"pdfTable",ref:S},[a("img",{src:h(o),class:"codes-img",ref_key:"image",ref:g},null,8,ue),me,fe,a("div",ge,[(s(!0),l(j,null,Z(r.codes,(E,k)=>(s(),l("div",{key:k,class:"code-block"},[a("div",be,p(k+1),1),a("span",he,p(E),1)]))),128))]),ve],512)],64))}},ye=`footer{background-color:#323232;display:flex;flex-wrap:wrap;width:100%;justify-content:space-between;align-items:center;padding:0;color:#fff}footer .info{padding:2em}footer .info p{margin:0}.codes-btn{background-color:var(--4229bb37);border:none;padding:1em;align-self:center;cursor:pointer;color:#fff}.codes-main{display:flex;flex-direction:column;align-items:center}.codes-img{height:200px;width:200px}.codes-hr{height:2em!important;background:var(--4229bb37);width:100%}.codes-title{text-align:center;border-bottom:1px solid rgb(93,93,93);align-self:center;padding:1.5em 0 .5em;line-height:1}.code-content{display:flex;padding:1em;align-items:center;flex-direction:column}.code-block{display:flex;padding:1.5em;align-items:center}.code-circle{background:var(--4229bb37);border-radius:50%;height:2em;width:2em;display:flex;justify-content:center;align-items:center;margin-right:1em;font-weight:700;color:#fff;font-size:1.7em}.code-code{font-size:1.5em}.download{text-align:center}.download:hover{color:var(--4229bb37)}.download:first-of-type{margin-top:1em}.download:last-of-type{margin-bottom:1em}.qrcode{width:150px;height:150px;align-self:center;margin:1em 0}.comp{display:flex;flex-direction:column;padding:0;font-family:var(--48b73b05)}@media screen and (min-width: 1200px){.comp{padding:0 .8em}}.comp .header{display:flex;justify-content:space-between;background-color:#9e9e9e;align-items:center;padding:17px 15px;z-index:100}@media screen and (min-width: 768px){.comp .header{padding:31px 24px}}@media screen and (min-width: 1200px){.comp .header{padding:0 1em 0 .5em}}.comp .header h1{padding-left:.5em;font-size:1.33333em;font-weight:400;line-height:1.44444rem;color:#fff}.comp .header .btn-edit{background-color:transparent;border:none}.comp .header .btn-edit .svg-edit{cursor:pointer;transition:all .25s ease;height:50px;width:50px}.comp .header .btn-edit .svg-edit:hover{stroke-width:1}@media screen and (min-width: 768px){.comp .header .btn-edit .svg-edit{height:40px;width:40px}}@media screen and (min-width: 1200px){.comp .header .btn-edit .svg-edit{height:32px;width:32px}}.comp .message{padding:1em;display:flex;align-items:center}.comp .error-msg{color:#e80000}.comp .success-msg{color:#0c7d0c}.comp .subhead{display:grid;grid-template-columns:repeat(3,1fr);align-items:center;height:5em;padding:1em}@media screen and (max-width: 768px){.comp .subhead{grid-template-columns:repeat(2,1fr);height:6em}.comp .subhead button{grid-column:1/3}}.comp .subhead h4{margin:0}.comp .subhead h6{margin:0;font-size:1rem;font-weight:700;line-height:1.33333rem;color:var(--4229bb37)}.comp hr{display:block;height:1px;border:0;border-top:1px solid #ccc;margin:0;padding:0}.comp .main{padding:1em;display:flex;flex-direction:column;justify-content:center}.comp .main .content{padding:1em}.comp .main .content .content-title{margin-bottom:2em}.comp .main .code{display:flex;flex-direction:column;width:100%}.comp .main .code .download{text-align:center}.comp .main .code .download:hover{color:var(--4229bb37)}.comp .main .code .download:first-of-type{margin-top:1em}.comp .main .code .download:last-of-type{margin-bottom:1em}.comp .main .code .qrcode{width:150px;height:150px;align-self:center;margin:1em 0}.comp .main .code .secret{margin:0 auto;color:#c31a19}.comp .main .actions{display:flex;width:100%;justify-content:space-between;align-items:center;margin-top:1em;flex-wrap:wrap}.comp .note{background-color:#fffbc6;padding:.5em 1em;margin:1em 0}.comp .btn{display:inline-block;text-align:center;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid trans;background-color:var(--4229bb37);border-color:var(--4229bb37);font-weight:400;letter-spacing:.01rem;padding:.5em 2em;border:1px solid var(--4229bb37);border-radius:0;font-size:1.25rem;color:#fff;vertical-align:middle;-webkit-transition:opacity .3s;transition:opacity .3s;width:100%;margin-top:.5em}.comp .btn:hover{font-weight:600;-webkit-box-shadow:none;box-shadow:none;letter-spacing:-.0075rem}@media screen and (min-width: 768px){.comp .btn{font-size:1.1rem;width:350px}}@media screen and (min-width: 1200px){.comp .btn{font-size:1rem}}.comp .btn-state{justify-self:flex-end}.comp .btn-right{margin-left:auto}.comp .btn-abort{background-color:transparent;color:#5d5d5d;border-color:#5d5d5d;display:flex;justify-content:center;align-items:center}.comp .btn-disabled{background-color:#9e9e9e;border-color:#9e9e9e;pointer-events:none}.comp .input-code{position:relative;height:2.5em;min-width:225px;padding:0 20px;border:1px solid rgb(93,93,93);border-radius:0;font-size:1.25rem;background:rgb(255,255,255);-webkit-box-shadow:none;box-shadow:none;text-overflow:ellipsis;align-self:center;text-align:center;margin-top:1em}.comp .input-code:focus{border-color:var(--4229bb37);outline:0px none;-webkit-box-shadow:0 0 0 1px var(--4229bb37);box-shadow:0 0 0 1px var(--4229bb37)}.comp .code-enter{width:100%;padding:0}.slide-up-enter-active,.slide-up-leave-active{transition:all .25s ease}.slide-up-enter-from,.slide-up-leave-to{opacity:0;transform:translateY(-30px)}.fade-enter-active,.fade-leave-active{transition:all .25s ease}.fade-enter-from,.fade-leave-to{opacity:0}.fade-enter-to,.fade-leave-from{opacity:1}
`,we=(r,i)=>{const g=r.__vccOpts||r;for(const[t,o]of i)g[t]=o;return g},xe={class:"comp"},ke={class:"header"},Ce=ie('<g transform="matrix(1.3333333,0,0,-1.3333333,0,34.179467)"><g transform="translate(21.6945,25.6347)"><path d="m0 0-0.855-0.856-0.619-0.619-15.054-15.053-1.26-4.791 4.772 1.316 16.509 16.509zM-2.288-3.523 0-1.239 2.255-3.494-0.033-5.777Zm-13.002-13.005 12.045 12.041 2.256-2.254-12.046-12.041z"></path></g><g transform="translate(0,20.6298)"><path d="m0 0v-20.63h19.703v11.724l-1.037-1v-9.686H1.038v18.556h9.629L11.704 0Z"></path></g></g>',1),Se=[Ce],Ue={width:"32px",height:"32px",viewBox:"0 0 16 16",fill:"none"},Me={key:0,fill:"rgb(232, 0, 0)",d:"M6.37119,11.87271h3.2554V14H6.37119ZM6.31551,2l.37063,8.54245H9.31386L9.68449,2Z"},Be={key:1,fill:"rgb(12, 125, 12)",d:"M14,4.69298L5.81846,12.87529l-3.81846-3.81846,1.63615-1.63692,2.25019,2.25019L12.43173,3.12471l1.56827,1.56827Z"},Ee={class:"subhead"},Ne={key:0},Te={key:0,class:"main"},Ge={class:"content"},ze={key:2,class:"note"},Le={key:0},$e={key:3,style:{"text-align":"center",margin:"1em"}},je=["href"],Ve={style:{display:"flex","justify-content":"center"}},De=["src"],Oe={key:1,class:"secret"},Ae={style:{display:"flex","justify-content":"center"}},Pe={class:"actions"},qe={key:0,width:"12px",height:"12px",viewBox:"0 0 1024 1024",style:{"margin-right":"0.5em"}},Fe=a("path",{d:"M768 903.232l-50.432 56.768L256 512l461.568-448 50.432 56.768L364.928 512z",fill:"rgb(93, 93, 93)"},null,-1),Ie=[Fe],Re=["disabled"],He={__name:"Custom-Mfa.ce",props:{translations:{type:String},primaryColor:{type:String,default:"#000"},font:{type:String,default:"'Open Sans', sans-serif"},logoUrl:{type:String,default:""},mfaStatusUrl:{type:String,default:""},mfaActivateUrl:{type:String,default:""},mfaDeactivateUrl:{type:String,default:""},mfaCheckVerificationCodeUrl:{type:String,default:""},mfaDownloadBackupCodesUrl:{type:String,default:""},mfaGenerateQrCodeUrl:{type:String,default:""},mfaGenerateNewBackupCodesUrl:{type:String,default:""}},setup(r){const i=r;ae(e=>({"4229bb37":r.primaryColor,"48b73b05":r.font})),H(()=>{i.mfaStatusUrl&&V()});const g=()=>{setTimeout(()=>{var e;(e=q.value)==null||e.focus()},300)},t=f(null),o=f(!1);f(!0);const c=()=>{o.value=!o.value,$.value=!1,t.value=z.value?_.backup.template:_.activation.template},y=T(()=>ce[t.value]),S=e=>{const m=[];for(let n in _)_[n].hasOwnProperty(e)&&m.push(_[n].template);return m},U=(e=null)=>{e?t.value=e==="deactivate"?"deactivate":"generate":t.value=z.value&&t.value==="deactivate"?"deactivation":"download",g()},w=T(()=>b(_[t.value].label)),x=T(()=>{var e;return S("execute").includes(t.value)?!d.value||![6,8].includes((e=d.value)==null?void 0:e.length):!1}),E=()=>{t.value==="backup"?U("generate"):t.value="backup"},k=f(null),M=f(null),d=f(null);oe(()=>d.value,(e,m)=>{d.value=e&&e.replace(/[^0-9]/g,"")});const z=f(null),Q=T(()=>{const e=z.value?"notes.active":"notes.inactive";return b(e)}),J="cips.mfa.",b=e=>JSON.parse(i.translations)[J+e],Y=()=>{_[t.value].action(),d.value=null},L=T(()=>(setTimeout(()=>{v.responseMessage.isError=null,v.responseMessage.msg=null},6e3),v.responseMessage)),B=e=>{v.responseMessage={isError:e.error,msg:e.errorMessage||e.successMessage},e.errorReason&&K(e.errorReason)},K=e=>{if(e==="session_required"){const m=de("login.do");setTimeout(()=>window.location.href=m,6e3)}},$=f(!1),V=async()=>{const e=await C(i.mfaStatusUrl,"GET");e.error||(z.value=e.multifactorAuthenticationEnabled)},q=f(null),W=async()=>{const e=await C(i.mfaGenerateQrCodeUrl,"GET");e.error||(k.value=e.QrCodeUrl,M.value=e.sharedSecret,v.sharedSecret=e.sharedSecret,t.value="active",g(),console.log("mfa qrcode",e)),B(e)},X=async()=>{const e=await C(i.mfaActivateUrl+`?sharedSecret=${v.sharedSecret}`,"GET");e.error||(V(),t.value="code",d.value=null,console.log("mfa activate",e)),B(e),v.sharedSecret=""},ee=async()=>{const e=await C(i.mfaDeactivateUrl,"GET");e.error||(V(),t.value="activation",d.value=null,console.log("mfa deactivate",e)),B(e)},N=async()=>{const e=v.sharedSecret,m=e?`?verificationCode=${d.value}&sharedSecret=${e}`:`?verificationCode=${d.value}`,n=await C(i.mfaCheckVerificationCodeUrl+m,"GET");n.error||(_[t.value].execute(),console.log("mfa verification",n)),B(n)},F=f([]),I=async()=>{const e=await C(i.mfaDownloadBackupCodesUrl,"GET");e.error||(d.value=null,console.log("mfa download codes",e),F.value=e.backupCodes,$.value=!0),B(e)},_={active:{template:"active",label:"buttons.activate_2fa",action:N,execute:X},activation:{template:"activation",label:"buttons.activate_2fa",action:W},code:{template:"code",label:"buttons.download_save_codes",action:I},backup:{template:"backup",label:"buttons.download_save_codes",action:U,leftBtn:"buttons.generate_codes"},deactivate:{template:"deactivate",label:"buttons.2fa_disable",action:U},inputs:{template:"inputs",label:"buttons.confirm_entry",action:N,leftBtn:"buttons.abort"},generate:{template:"generate",label:"buttons.confirm_entry",action:N,leftBtn:"buttons.abort",execute:async()=>{const e=await C(i.mfaGenerateNewBackupCodesUrl,"GET");e.error||(d.value=null,console.log("mfa new backup codes",e)),B(e)}},download:{template:"download",label:"buttons.confirm_entry",action:N,leftBtn:"buttons.abort",execute:I},deactivation:{template:"deactivation",label:"buttons.confirm_entry",action:N,leftBtn:"buttons.abort",execute:ee}};return(e,m)=>(s(),l("div",xe,[a("div",ke,[a("h1",{style:D({"font-weight":o.value?600:400})}," 2. "+p(b("notes.2fa_authentication")),5),a("button",{class:"btn-edit",onClick:c},[(s(),l("svg",{class:"svg-edit",viewBox:"0 0 33.583 34.179",x:"0px",y:"0px",width:"32px",height:"32px",stroke:"rgb(255, 255, 255)","stroke-width":"0",style:D({fill:o.value?"rgb(210, 210, 210)":"rgb(255, 255, 255)"})},Se,4))])]),O(A,{name:"slide-up",appear:""},{default:P(()=>[h(L).msg?(s(),l("div",{key:0,class:G(["message",h(L).isError?"error-msg":"success-msg"])},[(s(),l("svg",Ue,[h(L).isError?(s(),l("path",Me)):(s(),l("path",Be))])),R("   "+p(h(L).msg),1)],2)):u("",!0)]),_:1}),a("div",Ee,[a("h6",null,p(b("notes.status")),1),a("h4",null,p(h(Q)),1),O(A,{name:"fade",appear:""},{default:P(()=>[o.value&&t.value==="backup"?(s(),l("button",{key:0,onClick:m[0]||(m[0]=n=>U("deactivate")),class:"btn btn-state"},p(b("buttons.edit_2fa")),1)):u("",!0)]),_:1})]),o.value?(s(),l("hr",Ne)):u("",!0),O(A,{name:"slide-up",appear:""},{default:P(()=>[o.value&&!$.value?(s(),l("div",Te,[a("div",Ge,[(s(!0),l(j,null,Z(h(y),n=>(s(),l(j,null,[n.tag==="h3"?(s(),l("h3",{key:0,class:G(n.class)},p(b(n.label)),3)):u("",!0),n.tag==="p"&&!n.isNote?(s(),l("p",{key:1,style:D(n.style==="b"&&"font-weight: bold")},p(b(n.label)),5)):u("",!0),n.isNote?(s(),l("div",ze,[a("p",null,[a("b",null,p(b("notes.note")),1)]),n.isNote&&n.tag==="p"&&n.style!=="b"?(s(),l("p",Le,p(b(n.label)),1)):u("",!0)])):u("",!0),n.tag==="a"?(s(),l("p",$e,[a("a",{href:n.href,target:"_blank",class:"download"},p(b(n.label)),9,je)])):u("",!0),a("div",Ve,[n.tag==="img"?(s(),l("img",{key:0,src:k.value,alt:"qrcode",class:"qrcode"},null,8,De)):u("",!0),n.tag==="sec"?(s(),l("div",Oe,p(M.value),1)):u("",!0)])],64))),256)),a("template",Ae,[S("execute").includes(t.value)?ne((s(),l("input",{key:0,"onUpdate:modelValue":m[1]||(m[1]=n=>d.value=n),class:G(["input-code",t.value!=="active"&&"code-enter"]),maxlength:8,type:"text",name:"",id:"",ref_key:"code",ref:q},null,2)),[[se,d.value]]):u("",!0)])]),a("div",Pe,[S("leftBtn").includes(t.value)?(s(),l("button",{key:0,class:G(["btn",t.value!=="backup"&&"btn-abort"]),onClick:E},[t.value!=="backup"?(s(),l("svg",qe,Ie)):u("",!0),R(" "+p(b(_[t.value].leftBtn)),1)],2)):u("",!0),a("button",{class:G(["btn btn-right",{"btn-disabled":h(x)}]),onClick:Y,disabled:h(x)},p(h(w)),11,Re)])])):o.value&&$.value?(s(),le(_e,{key:1,"logo-url":r.logoUrl,"primary-color":r.primaryColor,codes:F.value},null,8,["logo-url","primary-color","codes"])):u("",!0)]),_:1})]))}},Ze=we(He,[["styles",[ye]]]),Qe=re(Ze);customElements.define("custom-mfa",Qe);
